### [Mode A] Quick Start 요청 (자연어 -> 리스트 -> 맵)
# 사용자가 처음 자연어로 프로세스를 요청하는 시나리오입니다.
# 1단계(Outliner)와 2단계(Transformer)가 순차적으로 실행됩니다.
POST http://localhost:8080/api/copilot/start
Content-Type: application/json

{
  "userPrompt": "직원 채용 프로세스를 만들어줘. 지원자가 이력서를 제출하면 HR이 검토하고, 합격하면 면접을 보고, 최종 합격하면 입사 처리를 하는 과정이야. 중간에 불합격하면 통보해야 해."
}

> {%
    client.global.set("modeA_JobId", response.body.jobId);
    client.log("Mode A Job ID saved: " + response.body.jobId);
%}

### [Mode A] 상태 조회 (Polling)
# 위 요청 실행 후 반복해서 상태를 확인하세요.
# 단계 변화: 1단계(리스트 작성) -> 2단계(맵 변환 & 자가수정) -> 완료
GET http://localhost:8080/api/copilot/status/{{modeA_JobId}}

---

### [Mode B] Transformation 요청 (리스트 JSON -> 맵)
# 프론트엔드(Outliner UI)에서 사용자가 직접 단계를 편집한 뒤, '맵 생성' 버튼을 눌렀다고 가정한 시나리오입니다.
# ProcessDefinition JSON을 직접 전송합니다.
POST http://localhost:8080/api/copilot/transform
Content-Type: application/json

{
  "topic": "Human Resources",
  "steps": [
    {
      "stepId": "1",
      "name": "Submit Request",
      "role": "Employee",
      "description": "The employee submits a request for leave, reimbursement, or any other HR-related matter through the designated HR system or form.",
      "type": "ACTION"
    },
    {
      "stepId": "2",
      "name": "Review Request",
      "role": "HR Manager",
      "description": "The HR manager reviews the submitted request for completeness and compliance with company policies.",
      "type": "ACTION"
    },
    {
      "stepId": "3",
      "name": "Decision on Request",
      "role": "HR Manager",
      "description": "The HR manager decides whether to approve or reject the request based on the review.",
      "type": "DECISION"
    },
    {
      "stepId": "4",
      "name": "Notify Employee",
      "role": "HR Manager",
      "description": "The HR manager communicates the decision to the employee, providing details on the approval or reasons for rejection.",
      "type": "ACTION"
    }
  ]
}

> {%
    client.global.set("modeB_JobId", response.body.jobId);
    client.log("Mode B Job ID saved: " + response.body.jobId);
%}

### [Mode B] 상태 조회 (Polling)
# Mode B는 1단계 없이 바로 2단계(Transformation)부터 시작합니다.
GET http://localhost:8080/api/copilot/status/{{modeB_JobId}}

---

### [Phase 3] 실시간 AI 제안 (Suggestion)
# 특정 노드(포커스 노드) 다음 단계에 무엇이 올지, 데이터 바인딩은 어떻게 할지 물어봅니다.
POST http://localhost:8080/api/copilot/suggest
Content-Type: application/json

{
  "focusNodeId": "node_review_resume",
  "currentGraphJson": "{ \"nodes\": [ { \"id\": \"node_review_resume\", \"type\": \"USER_TASK\", \"label\": \"Resume Review\", \"data\": { \"outputVariables\": [\"resume_score\", \"candidate_email\"] } } ] }"
}

### [Shadow Architect] 백그라운드 분석 요청 (POST /analyze)
# 시나리오: 사용자가 '휴가 승인' 노드를 만들었지만, 승인 경로만 연결하고 반려 경로를 연결하지 않음.
# 기대 결과: AI가 "반려 경로가 누락되었습니다"라는 ERROR 또는 WARNING을 반환해야 함.
POST http://localhost:8080/api/copilot/analyze
Content-Type: application/json

{
  "nodes": [
    {
      "id": "node_start",
      "type": "START",
      "label": "Start"
    },
    {
      "id": "node_submit",
      "type": "USER_TASK",
      "label": "휴가 신청서 작성",
      "data": { "nextActivityId": "node_approve" }
    },
    {
      "id": "node_approve",
      "type": "USER_TASK",
      "label": "팀장 승인",
      "data": {
        "configuration": { "isApproval": true }
      }
    },
    {
      "id": "node_end",
      "type": "END",
      "label": "End"
    }
  ],
  "edges": [
    { "source": "node_start", "target": "node_submit" },
    { "source": "node_submit", "target": "node_approve" },
    { "source": "node_approve", "target": "node_end", "label": "Approved" }
  ]
}

### [Shadow Architect] 구조 분석 요청 (Analyze API Test)
POST http://localhost:8080/api/copilot/analyze
Content-Type: application/json

{
  "nodes": [
    { "id": "node_1", "type": "USER_TASK", "label": "Task 1" }
  ],
  "edges": []
}